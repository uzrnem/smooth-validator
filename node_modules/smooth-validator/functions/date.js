const dataType = require('../dataType');

module.exports = {
  validateDate: function (varName, varValue) {
    if (!dataType.isDate(varValue))
      return { variable: varName, value: varValue, firstValue: varValue };
    return null;
  },
  validateDateComparison: function (type, varName, varValue, values, dataObj) {
    var compareTo = values[0]
    if (values[0] in dataObj) {
      compareTo = new Date(dataObj[values[0]]);
    } else if (compareTo == "today") {
      compareTo = new Date()
    } else if (compareTo == "yesterday") {
      compareTo = new Date()
      compareTo.setDate(compareTo.getDate() - 1);
    } else if (compareTo == "tomorrow") {
      compareTo = new Date()
      compareTo.setDate(compareTo.getDate() + 1);
    } else {
      compareTo = new Date(compareTo)
    }
    var actualDate = varValue;
    if ((actualDate instanceof Date) == false) {
      actualDate = new Date(varValue);
    }
    if (
      (type == 'after' && actualDate <= compareTo) ||
      (type == 'after_or_equals' && actualDate < compareTo) ||
      (type == 'before' && actualDate >= compareTo) ||
      (type == 'before_or_equals' && actualDate > compareTo)
    ) 
      return { variable: varName, value: varValue, firstValue: values[0] };
    return null;
  }
}